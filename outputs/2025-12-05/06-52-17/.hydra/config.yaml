experiment:
  debug: ${debug}
  tasks:
  - training_schedule_matrix
  training:
    precision: 16-mixed
    compile: false
    lr: 0.0002
    batch_size: 32
    max_epochs: -1
    max_steps: 200000
    max_time: null
    data:
      num_workers: 16
      shuffle: true
    optim:
      accumulate_grad_batches: 1
      gradient_clip_val: 10.0
    checkpointing:
      every_n_train_steps: null
      every_n_epochs: null
      train_time_interval: null
      enable_version_counter: false
      monitor: validation/crps_sum
      save_top_k: 1
      mode: min
      verbose: false
    every_n_train_steps: 10000
    early_stopping:
      monitor: validation/crps_sum
      patience: 6
      mode: min
      verbose: true
  validation:
    precision: 16-mixed
    compile: false
    batch_size: 16
    val_every_n_step: null
    val_every_n_epoch: 1
    limit_batch: null
    data:
      num_workers: 8
      shuffle: false
  test:
    precision: 16-mixed
    compile: false
    batch_size: 16
    limit_batch: null
    data:
      num_workers: 16
      shuffle: false
  training_schedule_matrix:
    compile: false
    epochs: 3
    lr: 0.001
    precision: 16-mixed
    train_batch_size: 512
    val_batch_size: 32
dataset:
  debug: ${debug}
  context_length: ???
  observation_shape: ???
  metadata: data/${dataset.name}/metadata.json
  data_mean: data/${dataset.name}/data_mean.npy
  data_std: data/${dataset.name}/data_std.npy
  name: ts_exchange
  gluonts_name: exchange_rate_nips
algorithm:
  debug: ${debug}
  lr: 0.0003
  x_shape: ${dataset.observation_shape}
  z_shape:
  - 1024
  frame_stack: 1
  data_mean: ${dataset.data_mean}
  data_std: ${dataset.data_std}
  external_cond_dim: 0
  context_frames: ${dataset.context_length}
  weight_decay: 0.001
  warmup_steps: 2000
  gt_first_frame: 0.0
  gt_cond_prob: 0.0
  uncertainty_scale: 1
  chunk_size: -1
  calc_crps_sum: 100
  learnable_init_z: false
  optimizer_beta:
  - 0.9
  - 0.999
  diffusion:
    network_size: 64
    beta_schedule: cosine
    objective: pred_v
    use_snr: false
    use_cum_snr: false
    snr_clip: 5.0
    cum_snr_decay: 0.9
    timesteps: 1000
    self_condition: false
    ddim_sampling_eta: 1.0
    p2_loss_weight_gamma: 0
    p2_loss_weight_k: 1
    schedule_fn_kwargs: {}
    sampling_timesteps: 10
    mask_unet: false
    num_gru_layers: 4
    num_mlp_layers: 1
    return_all_timesteps: false
    clip_noise: 20.0
  schedule_matrix:
    actions: 3
    positive_only: false
    build: true
    use_gae: true
    gamma: 0.99
    lam: 0.9
    value_coef: 0.25
    entropy_beta: 0.1
    denoise_bonus: 0.01
    rollout_multiple: 1
    max_roller: -1
    log_k_matrix: false
    k_matrix_log_every: 50
    k_matrix_batches: 1
    k_viz_max_steps: 150
    k_viz_summary_steps:
    - 1
    - 5
    - 10
    - 25
    raw_reward: true
    step_reward: true
    difference_step_reward: true
    denoise_reward: true
    multiply_denoise_bonus: 2
  metadata: ${dataset.metadata}
  use_covariates: true
  crps_group_size: null
debug: false
wandb:
  entity: a5rojas-uc-san-diego
  project: diffusion-forcing-scheduling-timeseries
  mode: disabled
resume: null
load: outputs/2025-11-07/05-10-26/checkpoints/epoch=13-step=1400.ckpt
name: testing
